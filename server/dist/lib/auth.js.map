{"version":3,"sources":["../../src/lib/auth.js"],"names":["APP_SECRET","process","env","EXPIRE_AT","hash","clear","compare","tokenize","payload","expiresIn","untokenize","token"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA;AACA,IAAMA,UAAU,GAAGC,OAAO,CAACC,GAAR,CAAYF,UAA/B;AACA,IAAMG,SAAS,GAAG,KAAlB;;AAEO,IAAMC,IAAI,GAAG,SAAPA,IAAO,CAAAC,KAAK;AAAA,SAAI,wBAASA,KAAT,EAAgB,CAAhB,CAAJ;AAAA,CAAlB;;;;AAEA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACD,KAAD,EAAQD,IAAR;AAAA,SAAiB,2BAAYC,KAAZ,EAAmBD,IAAnB,CAAjB;AAAA,CAAhB;;;;AAEA,IAAMG,QAAQ,GAAG,SAAXA,QAAW,CAAAC,OAAO;AAAA,SAAI,wBAAK;AAAEA,IAAAA,OAAO,EAAPA;AAAF,GAAL,EAAkBR,UAAlB,EAA8B;AAAES,IAAAA,SAAS,EAAEN;AAAb,GAA9B,CAAJ;AAAA,CAAxB;;;;AAEA,IAAMO,UAAU,GAAG,SAAbA,UAAa,CAAAC,KAAK;AAAA,SAAI,0BAAOA,KAAP,EAAcX,UAAd,EAA0BQ,OAA9B;AAAA,CAAxB","sourcesContent":["import { config } from 'dotenv';\nimport { hashSync, compareSync } from 'bcryptjs';\nimport { sign, verify } from 'jsonwebtoken';\n\nconfig();\nconst APP_SECRET = process.env.APP_SECRET;\nconst EXPIRE_AT = '24h';\n\nexport const hash = clear => hashSync(clear, 8);\n\nexport const compare = (clear, hash) => compareSync(clear, hash);\n\nexport const tokenize = payload => sign({ payload }, APP_SECRET, { expiresIn: EXPIRE_AT });\n\nexport const untokenize = token => verify(token, APP_SECRET).payload;\n"],"file":"auth.js"}