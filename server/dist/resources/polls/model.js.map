{"version":3,"sources":["../../../src/resources/polls/model.js"],"names":["pollSchema","mongoose","Schema","title","type","String","required","description","choices","validate","length","methods","results","model","aggregate","$match","poll","_id","$group","count","$sum","$sort"],"mappings":";;;;;;;AAAA;;;;AAEA,IAAMA,UAAU,GAAG,IAAIC,kBAASC,MAAb,CAAoB;AACrCC,EAAAA,KAAK,EAAE;AACLC,IAAAA,IAAI,EAAEC,MADD;AAELC,IAAAA,QAAQ,EAAE;AAFL,GAD8B;AAKrCC,EAAAA,WAAW,EAAE;AACXH,IAAAA,IAAI,EAAEC,MADK;AAEXC,IAAAA,QAAQ,EAAE;AAFC,GALwB;AASrCE,EAAAA,OAAO,EAAE;AACPJ,IAAAA,IAAI,EAAE,CAAC;AAAEG,MAAAA,WAAW,EAAEF;AAAf,KAAD,CADC;AAEPI,IAAAA,QAAQ,EAAE,kBAACD,OAAD;AAAA,aAAaA,OAAO,CAACE,MAAR,KAAmB,CAAhC;AAAA;AAFH;AAT4B,CAApB,CAAnB;;AAeAV,UAAU,CAACW,OAAX,CAAmBC,OAAnB,GAA6B,YAAY;AACvC,SAAO,KAAKC,KAAL,CAAW,MAAX,EAAmBC,SAAnB,CAA6B,CAClC;AAAEC,IAAAA,MAAM,EAAE;AAAEC,MAAAA,IAAI,EAAE,KAAKC;AAAb;AAAV,GADkC,EAElC;AACEC,IAAAA,MAAM,EAAE;AACND,MAAAA,GAAG,EAAE,YADC;AAENE,MAAAA,KAAK,EAAE;AAAEC,QAAAA,IAAI,EAAE;AAAR;AAFD;AADV,GAFkC,EAQlC;AAAEC,IAAAA,KAAK,EAAE;AAAE,eAAS,CAAC;AAAZ;AAAT,GARkC,CAA7B,CAAP;AAUD,CAXD;;eAaepB,kBAASY,KAAT,CAAe,MAAf,EAAuBb,UAAvB,C","sourcesContent":["import mongoose, { Types } from 'mongoose';\n\nconst pollSchema = new mongoose.Schema({\n  title: {\n    type: String,\n    required: true\n  },\n  description: {\n    type: String,\n    required: true\n  },\n  choices: {\n    type: [{ description: String }],\n    validate: (choices) => choices.length !== 0\n  }\n});\n\npollSchema.methods.results = function () {\n  return this.model('Vote').aggregate([\n    { $match: { poll: this._id } },\n    {\n      $group: {\n        _id: \"$selection\",\n        count: { $sum: 1 }\n      }\n    },\n    { $sort: { \"count\": -1 } }\n  ]);\n};\n\nexport default mongoose.model('Poll', pollSchema);\n"],"file":"model.js"}